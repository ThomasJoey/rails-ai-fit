<div class="events-page" data-controller="events">

  <!-- 🔍 Barre de recherche -->
  <div class="search-bar">
    <i class="icon-search">🔍</i>
    <input type="text"
           placeholder="Rechercher un événement..."
           data-events-target="searchInput"
           data-action="input->events#search">
  </div>

  <!-- Boucle dynamique -->
  <% @events.each do |event| %>
    <div class="event-card" data-events-target="card">
      <div class="event-header">
        <div class="event-icon">🎯</div>
        <div class="event-title">
          <h3><%= event.title %></h3>
        </div>
      </div>

      <p class="event-desc"><%= event.description %></p>
      <ul class="event-info">
        <li>📅 <%= l(event.starts_at, format: :long) %></li>
        <li>📍 <%= event.location %></li>
      </ul>

      <div class="event-footer">
        <%= turbo_frame_tag dom_id(event, :participation_button) do %>
          <% if current_user.events.include?(event) %>
            <%= button_to "Inscrit ✅",
                          event_participation_path(current_user.event_participations.find_by(event: event)),
                          method: :delete,
                          class: "btn btn-success btn-join" %>
          <% else %>
            <%= button_to "S'inscrire",
                          event_event_participations_path(event),
                          method: :post,
                          class: "btn btn-outline-primary btn-join" %>
          <% end %>
        <% end %>

      </div>

    </div>
  <% end %>

  <!-- 🌟 Popup global -->
  <div id="signup-popup" class="popup-overlay hidden" data-events-target="popup">
    <div class="popup">
      <h3>✅ Inscription réussie</h3>
      <p>Vous êtes bien inscrit…</p>
      <button class="btn-close" data-action="click->events#closePopup">Fermer</button>

    </div>
  </div>


</div>
