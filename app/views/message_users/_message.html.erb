<% is_current_user = message.sender == current_user %>

<div class="chat-message d-flex mb-3 <%= is_current_user ? 'justify-content-end' : 'justify-content-start' %>">
  <% unless is_current_user %>
    <%= render "layouts/avatar",
        initials: message.sender.first_name&.first&.upcase || "?",
        image_url: (url_for(message.sender.avatar) if message.sender.avatar.attached?),
        size: "sm",
        gradient: "gradient-purple-pink",
        extra_classes: "me-2" %>
  <% end %>

  <div class="message-block">
    <div class="chat-bubble <%= is_current_user ? 'outgoing' : 'incoming' %>">
      <%= simple_format(h(message.content)) %>
    </div>
    <div class="chat-time-below text-muted small mt-1 <%= is_current_user ? 'text-end' : 'text-start' %>"><%= l(message.created_at, format: :short) %></div>
  </div>
</div>
