<div class="conversation-container container py-4">
  <!-- Header -->
  <div class="conversation-header text-center mb-4">
    <h1><%= @conversation.title %></h1>
    <p class="text-muted"><%= @conversation.context %></p>
  </div>

  <!-- Messages -->
  <div class="conversation-messages">
    <% @messages.each do |message| %>
      <div class="chat-message <%= message.role %>">
        <div class="bubble">
          <% if message.role == "user" %>
            <p class="mb-0"><%= message.content %></p>
          <% else %>
            <% if message.events.any? %>
              <% message.events.each do |event| %>
                <div class="event-card">
                  <h5><%= event.title %></h5>
                  <p><%= event.description %></p>
                  <p><strong>üìç</strong> <%= event.location %></p>
                  <% if event.starts_at.present? %>
                    <p><strong>üïí</strong> <%= event.starts_at.strftime("%d/%m/%Y %H:%M") %></p>
                  <% end %>
                  <% if event.ends_at.present? %>
                    <p><strong>üèÅ</strong> <%= event.ends_at.strftime("%d/%m/%Y %H:%M") %></p>
                  <% end %>
                </div>
              <% end %>
            <% else %>
              <p class="mb-0"><%= message.content %></p>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Formulaire -->
  <div class="conversation-form mt-3">
    <%= simple_form_for [@conversation, @message], html: { class: "d-flex" } do |f| %>
      <%= f.input :content, as: :text, input_html: { rows: 1, placeholder: "√âcris ton message...", class: "form-control me-2 message_content" }, label: false %>
      <%= f.button :submit, "Envoyer", class: "btn btn-primary form-control" %>
    <% end %>
  </div>
</div>
