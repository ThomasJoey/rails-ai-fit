<!-- app/views/profiles/show.html.erb -->
<div class="container py-5 profile-page">
  <h1>Mon Profil</h1>
  <div class="profile-card">
    <!-- Section Avatar avec upload -->
    <div class="position-relative d-inline-block">
    <%= render "layouts/avatar",
      image_url: (url_for(@user.avatar) if @user.avatar.attached?),
      initials: user_initials(@user),
      size: "xl",
      extra_classes: "profile-avatar" %>

    <% if @user == current_user %>
      <%= link_to edit_profile_path(@user),
          class: "position-absolute bottom-0 end-0 btn btn-sm btn-primary rounded-circle p-2",
          style: "transform: translate(-10%, -10%); width: 40px; height: 40px;",
          title: "Modifier la photo" do %>
        <i class="fas fa-camera"></i>
      <% end %>
    <% end %>
  </div>

    <div class="name">
      <%= @user.first_name %> <%= @user.last_name %>
      <% if @user.first_name.blank? && @user.last_name.blank? %>
        <%= @user.email.split('@').first.capitalize %>
      <% end %>
    </div>

    <div class="location">üìç <%= @user.location %></div>
    <% if @user != current_user %>
      <%= link_to "envoyer un message", conversation_path(@conversation), class: "text-decoration-none" %>
    <% end %>
    <% if @user.bio.present? %>
      <div class="bio mt-3">
        <p><%= @user.bio %></p>
      </div>
    <% end %>

    <!-- Section sports favoris avec nouveau design -->
    <% if @user.sports.present? %>
      <div class="sports-section mt-4">
        <div class="section-title">Mes sports favoris :</div>
        <div class="sports-badges">
          <% @user.sports.each do |sport| %>
            <span class="sport-badge">
              <i class="fas fa-star"></i> <%= sport.humanize %>
            </span>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Bouton pour √©diter le profil -->
    <div class="mt-3">
      <%= link_to "Modifier mon profil", edit_profile_path(@user), class: "btn btn-outline-primary" if @user == current_user %>
    </div>
  </div>

  <h2>üìÖ Mes √©v√©nements</h2>
  <!-- ta liste des events ici -->
  <% if @events.any? %>
    <ul class="list-group">
      <% @events.each do |event| %>
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <strong><%= event.title %></strong><br>
            <small class="text-muted"><%= event.location %> ‚Äî <%= l(event.starts_at, format: :long) %></small>
          </div>
          <%= link_to "Voir", event_path(event), class: "btn btn-sm btn-outline-primary" %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p class="text-muted">Tu ne participes encore √† aucun √©v√©nement.</p>
  <% end %>
</div>
