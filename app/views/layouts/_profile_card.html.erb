<div class="user-profile-card shadowed">

  <!-- Header avatar + nom -->
    <% if user == current_user %>
      <%= link_to edit_profile_path(user), class: "edit-btn" do %>
        <i class="fa-solid fa-pen-to-square"></i>
      <% end %>
    <% end %>
  <div class="profile-header d-flex align-items-center gap-3 mb-3">
     <%= image_tag user.avatar_url,
        alt: "#{user.first_name} #{user.last_name}",
        class: "avatar-wrapper me-3" %>

    <div>
      <div class="profile-name fw-bold fs-5">
        <%= user.first_name %> <%= user.last_name %>
        <% if user.first_name.blank? && user.last_name.blank? %>
          <%= user.email.split('@').first.capitalize %>
        <% end %>
      </div>

      <% if user.age.present? || user.location.present? %>
        <div class="profile-subtext text-muted d-flex align-items-center gap-2" style="margin-top: 4px;">
          <% if user.age.present? %>
            <span><%= user.age %> ans</span>
          <% end %>

           <% if user.location.present? %>
            <span>
              <i class="fa-solid fa-location-dot" style="margin-right: 4px;"></i>
              <%= user.location %>
            </span>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Sports principaux -->
  <% badge_styles = ['badge-orange', 'badge-pink', 'badge-green', 'badge-blue'] %>

  <% if user.sports.present? %>
    <div class="profile-tags d-flex flex-wrap gap-2 mb-3">
      <% user.sports.each do |sport| %>
        <span class="badge badge-purple"><%= sport.humanize %></span>
      <% end %>
    </div>
  <% end %>

  <!-- À propos -->
  <% if user.bio.present? %>
    <div class="profile-bio mb-4">
      <h4 class="mb-2">À propos</h4>
      <p class="text-body"><%= simple_format(user.bio) %></p>
    </div>
  <% end %>

  <!-- Boutons -->
  <div class="profile-actions d-flex flex-column gap-2">
    <% if user != current_user && enableMessage %>
      <%= link_to (conversation ? conversation_path(conversation) : conversations_path(second_user_id: user.id)),
                  class: "btn btn-icon shadowed d-flex align-items-center justify-content-center" do %>
        <i class="fa-solid fa-message"></i>
      <% end %>
    <% end %>
  </div>


  <div class ="title-events">Mes événements</div>
    <% if @events.present? %>
      <ul class="list-group" id="my_events_list">
        <% @events.each do |event| %>
          <li class="list-group-item d-flex justify-content-between align-items-center" id="<%= dom_id(event, :profile_item) %>">
            <div>
              <strong><%= event.title %></strong><br>
              <small class="text-muted"><%= event.location %> — <%= l(event.starts_at, format: :long) %></small>
            </div>
              <%= link_to "Voir", events_path, class: "btn btn-sm btn-outline-primary" %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="subtitle-events">Tu ne participes encore à aucun événement.</p>
      <ul class="list-group" id="my_events_list"></ul>
    <% end %>
</div>
