<div class="profile-card">
  <!-- Section Avatar avec upload -->
  <div class="position-relative d-inline-block">
    <%= render "layouts/avatar",
      image_url: (url_for(user.avatar) if user.avatar.attached?),
      initials: user_initials(user),
      size: "xl",
      extra_classes: "profile-avatar" %>

    <% if user == current_user %>
      <%= link_to edit_profile_path(user),
          class: "position-absolute bottom-0 end-0 btn btn-sm btn-primary rounded-circle p-2",
          style: "transform: translate(-10%, -10%); width: 40px; height: 40px;",
          title: "Modifier la photo" do %>
        <i class="fas fa-camera"></i>
      <% end %>
    <% end %>
  </div>

  <div class="name">
    <%= user.first_name %> <%= user.last_name %>
    <% if user.first_name.blank? && user.last_name.blank? %>
      <%= user.email.split('@').first.capitalize %>
    <% end %>
    <%= "#{user.age_range} ans" %>
  </div>

  <div class="location">üìç <%= user.location %></div>

  <% if enableMessage %>
    <% if user != current_user && conversation %>
      <%= link_to "Envoyer un message", conversation_path(conversation), class: "text-decoration-none" %>
    <% else %>
      <%= link_to 'Envoyer un message', conversations_path(second_user_id: user.id), data: { turbo_method: :post } %>
    <% end %>
  <% end %>

  <% if validPlace %>
    <div class="icons-actions" style="display: flex; justify-content: center; gap: 20px; margin-top: 10px;">
      <i class="fa-solid fa-check"
        style="border: 2px solid green; border-radius: 50%; padding: 8px; color: green; font-size: 20px; cursor: pointer; transition: 0.2s;"></i>

      <i class="fa-solid fa-xmark"
        style="border: 2px solid red; border-radius: 50%; padding: 8px; color: red; font-size: 20px; cursor: pointer; transition: 0.2s;"></i>
    </div>
  <% end %>
  <% if user.bio.present? %>
    <div class="bio mt-3">
      <p><%= user.bio %></p>
    </div>
  <% end %>

  <% if user.sports.present? %>
    <div class="sports-section mt-4">
      <div class="section-title">Mes sports favoris :</div>
      <div class="sports-badges">
        <% user.sports.each do |sport| %>
          <span class="sport-badge">
            <i class="fas fa-star"></i> <%= sport.humanize %>
          </span>
        <% end %>
      </div>
    </div>
  <% end %>

  <div class="mt-3">
    <%= link_to "Modifier mon profil", edit_profile_path(user), class: "btn btn-outline-primary" if user == current_user %>
  </div>
</div>
