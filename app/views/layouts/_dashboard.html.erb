<div class="offcanvas offcanvas-start dashboard-offcanvas" tabindex="-1" id="dashboardMenu" aria-labelledby="dashboardMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title fw-bold" id="dashboardMenuLabel">Dashboard</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>

  <div class="offcanvas-body dashboard-body">
  <%= render "dashboards/search" %>
    

    <turbo-frame id="dashboard_search_results"></turbo-frame>

    <%# Valeurs par défaut pour que le panneau fonctionne sur toutes les pages %>
    <% @weather ||= { city: "Paris", temp: 18, label: "Parfait pour courir" } %>
    <% @stats ||= { matches: 3, messages: 12, events: 5 } %>
    <% placeholder = "https://ui-avatars.com/api/?name=%{n}&background=7F56D9&color=fff&size=128" %>
    <% @users_nearby ||= [
      { name: "Emma", age: 26, sport: "Running", distance: 0.8, match: 92, avatar: placeholder % { n: "Emma" } },
      { name: "Lucas", age: 29, sport: "CrossFit", distance: 1.2, match: 88, avatar: placeholder % { n: "Lucas" } },
      { name: "Sofia", age: 24, sport: "Yoga", distance: 2.1, match: 75, avatar: placeholder % { n: "Sofia" } }
    ] %>
    <% @recent_matches ||= [
      { name: "Alex", sport: "Cyclisme", last_seen: "il y a 2h", avatar: placeholder % { n: "Alex" }, unread: true },
      { name: "Emma", sport: "Running", last_seen: "hier", avatar: placeholder % { n: "Emma" }, unread: false }
    ] %>
    <%# Assure la présence des événements de l'utilisateur sur toutes les pages %>
    <% @events ||= (current_user&.events&.order(starts_at: :asc) || []) %>
    <% @events_today ||= [
      { title: "Course matinale au Bois", time: "07:30", place: "Bois de Vincennes", participants: "8/12", joinable: true },
      { title: "Session CrossFit", time: "18:00", place: "FitClub Central", participants: nil, joinable: false }
    ] %>

    <%= render "dashboards/header" %>
    <%= render "dashboards/weather" %>
    <%= render "dashboards/users_nearby" %>
    <%= render "dashboards/recent_matches" %>
    <%= render "dashboards/events_today" %>

  </div>
</div>
